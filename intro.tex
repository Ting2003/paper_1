\section{Introduction}
Due to the development of CMOS technology, transistor size becomes more and more smaller. The higher density of transistors in the integrated chip requires denser power supply network (power grid) to supply more power. As a result, power grid becomes larger and larger in size, which usually contains millions of nodes. On the other hand, due to the metal interconnections and inductances in the network, there is a voltage drop across the network. This voltage drop is called ``IR-drop". Actual supply voltages of transistors may be less than the global supply voltage of power grid. Affected by the parameters of the network such as inductors and interconnections, the ``IR-drop'' may cause large delay or even malfunction of the circuit. As a result, after designing the power supply network for the circuit, it is important to verify the design by performing IR-drop analysis. There are mainly two types of
IR-drop analysis in power grid: DC analysis and transient analysis. DC analysis assumes the grid is composed with only resistors and the current is static. Transient analysis models the power grid as a network with resistors, capacitances and inductances. In transient analysis, current is a varying vector with time. Because transient analysis simulates the power grid with a more accurate model and considering the time as a factor for IR-drop analysis, transient analysis has more accurate results than DC analysis, but it also consumes much longer simulation time. Combined the fact that power grid is in large size, the cost of runtime and memory for transient analysis of power grid maybe too expensive to afford. 

As it may be prohibitively expensive to performing transient IR-drop analysis of power grid, it is highly desirable to develop an efficient solver to overcome the problem. In this paper, we focus on parallel solver for transient IR-drop analysis. There are already
several works talking about parallel DC solver, including domain decomposition\cite{PETSC_website, kaisun, voronov}, multigrid\cite{Zhuofeng,Kozhaya}, parallel LU\cite{Super_LU_website} and so on. The effectiveness of these methods may be weak for transient analysis, which is due to different bottleneck factors for DC and transient simulation. In DC analysis, over 95\% of runtime is consumed 
for conductance matrix factorization. The forward and backward solving process only cost little time. An effective way to reduce the time for 
matrix decomposition is to build local matrices instead of the global one. Although iterations need to be performed before convergence, which will cause a little extra time for forward and backward solving, this extra cost is still worthy because much more time is saved in matrix factorization stage. In transient analysis, the matrix factorization is not the most critical factor. Instead, since a lot of time steps are required to be solved, which is usually in thousands, the bottleneck for transient analysis is the forward and backward solving process. Only one or two matrix decompositions are needed to be done. For a 1000 time step transient simulation of power grid with 2M nodes, the time for 
forward and backward solving process is 1.5 times of that of matrix factorization. If more time steps are required to be simulated, longer time would be spent on the forward and backward solving stage.

Because of this difference in bottlenecks for DC and transient analysis, the same strategy for speeding up DC analysis may even slower transient analysis. For example, with the strategy of breaking the global matrix into several local matrices and use iterations to get the final solution for one time step, iteration time costed per time step is larger than a single forward and backward solve. Though it saves some time in matrix factorization, the ratio of the time saving is not so significant as DC analysis, because the ratio of solving is larger than factorization stage. Besides, due to the large amount of time steps, the total extra time cost with the iteration method during solving 
process will be larger than the time saved in factorization stage. As a result, the methods for speeding up the DC analysis is not suitable for transient analysis. 

For multigrid method in\cite{Zhuofeng,Kozhaya}, the fine grid results are iteratively corrected by coarse ones. Again, the iterative process is performed in each time step. For similar reason as DC analysis, the total time for solving stage may lead to slower than basic direct solver. Besides, error may exist with multigrid method because of the approximation process. The error accumulates as time step goes by and finally become intractable. 

There are also some other works about parallelization for transient analysis of linear systems, for example, \cite{Alvarado, Scala, 
Chai}. However, there are some limitations of these methods, which make them not suitable for power grid simulation. For example, in 
\cite{Alvarado}, with $T/2$ processors, $2^T$ time steps can be solved in $T$ steps. However, this method requires integrating 
the matrix of $2^T$ time steps into a global matrix. In each of the $T$ steps, a quarter size of the global matrix is decomposed. The new global matrix that need to factorize is $2^T$ times of the original one, which not only cost a lot more time for decomposition but also increase the system memory requirement. The characteristic limits the size that this
method can solve is very small. Considering the size of power grid is usually large, this method is not suitable for power grid simulation. \cite{Chai} parallelizes the iterative method such as domain decomposition. Parallelization is performed both for different time steps and iterations within one time step. The parallel process is similar
to pipeline technique. Iterations are overlapped together to reduce the simulation time. The amount of time saving depends on number of iterations. If the processor resource is sufficient, for $T$ time steps where each time step needs $N$ iterations to converge, $T+N$ of unit iteration time is cost. The total time saving is $T\times N - (T+N)$. The larger $N$, the more time saving. However, compared to direct
solver for transient analysis, the larger $N$ means the iteration method itself is more slower than the direct solver. Besides, with this method, the maximum speed up is $\frac{T\times N}{(T+N)} \approx N$, which happens for small $N$. Limited amount of speed up over the sequential version may be arrived, while the iterative sequential solver is slower than the direct solver. It is not clear that this method can bring speedup to transient analysis for power grid. 
At the same time, in each iteration, this method requires a large amount of data communication to update the solution of nodes. Considering the two factors mentioned above, this method is also not suitable for transient power grid analysis. 

This paper proposes an efficient parallel solver for power grid transient analysis: PGT\_SOLVER. The solver is based on direct solver. After factorizing global conductance matrix, one forward and backward substitution is performed in each time step. Several methods are developed 
to speedup the program, for example, sparse vector technique, smart mapping technique, and supernode technique. Multi threads are utilized to work on independent components of power grid, which effectively introduces speedup. The main contributions are as follows:
  \begin{enumerate}[1)]
  \item Trapezoidal model of capacitance and inductance is utilized to generate a symmetric positive definite conductance, which is then decomposed with Cholesky method, thus saves both time and storage space for factorization.
  \item Sparse vector technique is utilized to avoid solving all the nodes in the power grid.
  \item Smart mapping technique is proposed to locate the corresponding node index before and after reordering introduced in matrix 		decomposition stage.
  \item Supernode technique is utilized to accelerate the solving process.
  \item Multiple threads are utilized to work on independent components of power grid to introduce parallel and speedup the simulation process.
  \item The proposed software won first prize of TAU\_2012. Experimental results on several industrial benchmarks shows that this software can fast perform transient analysis of power grid without losing any accuracy. 
  \end{enumerate} 

The rest of this paper is organized as follows. Section 2 discusses models of transient analysis. Section 3 presents the proposed method. 
Experimental results are illustrated in section 4. Conclusion is given in section 5.
